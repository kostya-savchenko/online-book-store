databaseChangeLog:
  - changeSet:
      id: 16-insert-shopping-carts-to-users
      author: ksavchenko
      changes:
        - sql:
            splitStatements: false
            sql: >
              INSERT INTO shopping_carts (user_id)
              SELECT u.id FROM users u
              WHERE NOT EXISTS (
                SELECT 1 FROM shopping_carts c
                WHERE c.user_id = u.id
              );
      rollback:
        - sql:
            sql: >
              DELETE FROM shopping_carts
              WHERE user_id IN (
                SELECT id FROM users
              );